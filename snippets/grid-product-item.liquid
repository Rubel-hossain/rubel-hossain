{% comment %}
  Snippet: grid-product-item
  Renders a single product item for the Products Grid View section
{% endcomment %}

{%- liquid
  assign product_obj = product
  assign custom_image = image
  assign x_position = hotspot_x | default: 85
  assign y_position = hotspot_y | default: 15
-%}

<div class="product-showcase__item" {{ block_attributes }}>
  <div class="product-showcase__item-wrapper">
    {%- if product_obj == blank -%}
      {%- comment -%} No product selected - show placeholder {%- endcomment -%}
      <div class="product-showcase__placeholder product-showcase__placeholder--empty">
        <div class="product-showcase__placeholder-content">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" class="product-showcase__placeholder-icon">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="16"/>
            <line x1="8" y1="12" x2="16" y2="12"/>
          </svg>
          <h3 class="product-showcase__placeholder-title">Select Product</h3>
          <p class="product-showcase__placeholder-description">Choose a product to showcase</p>
        </div>
      </div>
    {%- else -%}
      {%- comment -%} Product is selected {%- endcomment -%}
      {%- if custom_image != blank -%}
        {%- assign image_alt = image_alt | default: product_obj.title | escape -%}
        <picture class="product-showcase__picture">
          <source 
            media="(max-width: 749px)"
            srcset="{{ custom_image | image_url: width: 600 }} 1x, {{ custom_image | image_url: width: 1200 }} 2x">
          <source 
            media="(min-width: 750px)"
            srcset="{{ custom_image | image_url: width: 800 }} 1x, {{ custom_image | image_url: width: 1600 }} 2x">
          <img 
            class="product-showcase__image"
            src="{{ custom_image | image_url: width: 800 }}"
            alt="{{ image_alt }}"
            loading="lazy"
            width="800"
            height="1067">
        </picture>
      {%- elsif product_obj.featured_image != blank -%}
        {%- comment -%} Use product image if no custom image is set {%- endcomment -%}
        <picture class="product-showcase__picture">
          <source 
            media="(max-width: 749px)"
            srcset="{{ product_obj.featured_image | image_url: width: 600 }} 1x, {{ product_obj.featured_image | image_url: width: 1200 }} 2x">
          <source 
            media="(min-width: 750px)"
            srcset="{{ product_obj.featured_image | image_url: width: 800 }} 1x, {{ product_obj.featured_image | image_url: width: 1600 }} 2x">
          <img 
            class="product-showcase__image"
            src="{{ product_obj.featured_image | image_url: width: 800 }}"
            alt="{{ product_obj.title | escape }}"
            loading="lazy"
            width="800"
            height="1067">
        </picture>
      {%- else -%}
        <div class="product-showcase__placeholder">
          {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
          <span class="product-showcase__placeholder-text">Add product image</span>
        </div>
      {%- endif -%}

      <button 
        type="button"
        class="product-showcase__hotspot"
        aria-label="View {{ product_obj.title | escape }}"
        data-product-handle="{{ product_obj.handle | escape }}"
        style="--hotspot-x: {{ x_position }}%; --hotspot-y: {{ y_position }}%;">
        <span class="product-showcase__hotspot-indicator">
          <svg class="product-showcase__hotspot-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </span>
        <span class="product-showcase__hotspot-pulse"></span>
      </button>
      
      {%- comment -%} Product info overlay {%- endcomment -%}
      <div class="product-showcase__product-info">
        <span class="product-showcase__product-title">{{ product_obj.title }}</span>
        <span class="product-showcase__product-price">{{ product_obj.price | money }}</span>
      </div>
    {%- endif -%}
  </div>
</div>
